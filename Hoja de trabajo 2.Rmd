---
title: "Hoja de Trabajo 2"
author: "Josué Sagastume, Cristopher Barrios, Diego Ruiz"
date: "18/2/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r echo=FALSE}
library(cluster) #Para calcular la silueta
library(e1071)#para cmeans
library(mclust) #mixtures of gaussians
library(fpc) #para hacer el plotcluster
library(NbClust) #Para determinar el número de clusters óptimo
library(factoextra) #Para hacer gráficos bonitos de clustering
library(tidyverse)
movies <- read.csv("tmdb-movies.csv")
```

### Preprocesamiento del dataset
#### 1. Variables que no aportan informacion a la generacion de grupos

Id, imdb_id, original_title, cast, homepage, director, tagline, keywords, overview, genres, production_companies, release_date. Ya que estas no son variables cuantitativas no se pueden agrupar y no aportarian ningun valor a los clusters. Sin embargo, al momento de interpretar la informacion se van a ser necesarias.

```{r echo=FALSE}
moviesCuanti <- select(movies, popularity, budget, revenue, runtime, vote_average, release_year)

moviesCuantiCompleto <- moviesCuanti[complete.cases(moviesCuanti),]
```

#### 2. Numero de grupos a formar
```{r echo=FALSE}
km <- kmeans(moviesCuantiCompleto,3,iter.max=10)

wss <- (nrow(moviesCuantiCompleto)-1)*sum(apply(moviesCuantiCompleto,2,var))

for (i in 2:25) 
  wss[i] <- sum(kmeans(moviesCuantiCompleto, centers=i)$withinss)

plot(1:25, wss, type="b", xlab="Cantidad de Clusters",  ylab="Cantidad de suma de cuadrados")

noClusters <- 4
```

Basándonos en la gráfica de codo, se puede determinar que la cantidad óptima de clusters a utilizar es de 4.

#### 3. Utilice 3 algoritmos existentes para agrupamiento. Compare los resultados por cada uno
##### a. Método de agrupamiento con Kmeans
```{r echo=FALSE}
km<-kmeans(moviesCuantiCompleto,noClusters,iter.max =100)
movies$grupo <- km$cluster
plotcluster(moviesCuantiCompleto,km$cluster)
```

#### b. Método de Fuzzy Cmeans
```{r echo=FALSE}
fcm<-cmeans(moviesCuantiCompleto,noClusters)
movies$FCGrupos<-fcm$cluster
movies<-cbind(movies,fcm$membership)
plotcluster(moviesCuanti,fcm$cluster)
```

#### c. Método de Mix of Gaussians
```{r echo=FALSE}
mc<-Mclust(moviesCuantiCompleto,noClusters)
plot(mc, what = "classification", main="MClust Classification")
movies$mxGau<-mc$classification
g1MC<-movies[movies$mxGau==1,]
g2MC<-movies[movies$mxGau==2,]
g3MC<-movies[movies$mxGau==3,]
g4MC<-movies[movies$mxGau==4,]
```

### 4. Calidad del agrupamiento hecho por cada algoritmo con el método de la silueta
#### a. Silueta para método de agrupamiento con Kmeans
```{r echo=FALSE}
silkm<-silhouette(km$cluster,dist(moviesCuantiCompleto))
mean(silkm[,3]) #0.55, no es la mejor particiÃ³n pero no estÃ¡ mal
```

#### b. Silueta para método de agrupamiento con Fuzzy Cmeans
```{r echo=FALSE}
silfcm<-silhouette(fcm$cluster,dist(moviesCuantiCompleto))
mean(silfcm[,3]) #0.54, no es la mejor particiÃ³n pero no estÃ¡ mal

```

#### c. Silueta para método de agrupamiento de mix of Gaussians
```{r echo=FALSE}
silmg<-silhouette(mc$classification,dist(moviesCuantiCompleto))
mean(silmg[,3]) #0.50, no es la mejor particiÃ³n pero no estÃ¡ mal

```


